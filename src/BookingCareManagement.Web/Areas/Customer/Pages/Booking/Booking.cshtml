@page "/booking"
@model BookingCareManagement.Areas.Customer.Pages.Booking.BookingModel
@{
    ViewData["Title"] = "Đặt lịch";
}

@section Styles {
    <link rel="stylesheet" href="~/css/booking.css" asp-append-version="true" />
}

<div class="container-fluid mt-5 pt-4">
    <div class="row justify-content-center">
        <!-- KHUNG TRÁI -->
        <div id="booking-left" class="col-lg-7 col-md-8 col-sm-12 p-4 rounded-4 bg-dark text-light me-lg-3">
            <!-- Tiêu đề bên trái -->
            <div class="d-flex align-items-center mb-4">
                <button id="btn-back" class="btn btn-outline-light btn-sm me-2 d-none">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
                <h4 class="fw-bold mb-0" id="left-title">Chọn chuyên khoa</h4>
            </div>

            <!-- Ô tìm kiếm -->
            <div class="input-group mb-4">
                <input type="text" id="search-box" class="form-control rounded-pill px-3 search-services-booking" placeholder="Tìm kiếm chuyên khoa" />
            </div>

            <!-- Danh sách chuyên khoa -->
            <div id="service-list">
                <div class="text-center text-secondary py-5">
                    Đang tải danh sách chuyên khoa...
                </div>
            </div>

            <!-- Danh sách bác sĩ -->
            <div id="employee-list" class="d-none">
                <div class="text-center text-secondary py-5">
                    Vui lòng chọn chuyên khoa trước.
                </div>
            </div>

            <!-- Danh sách ngày & giờ -->
            <div id="datetime-list" class="d-none">
                <div class="mb-4">
                    <label for="date-picker" class="form-label fw-semibold">Chọn ngày</label>
                    <input type="date" id="date-picker" class="form-control bg-dark text-light border-secondary" />
                </div>

                <div class="mb-4">
                    <label for="time-slot" class="form-label fw-semibold">Chọn giờ</label>
                    <select id="time-slot" class="form-select bg-dark text-light border-secondary" disabled>
                        <option value="">-- Vui lòng chọn ngày trước --</option>
                    </select>
                </div>

                <button id="confirm-datetime" class="btn btn-success mt-3">Xác nhận</button>
            </div>

            <!-- PHẦN THANH TOÁN -->
            <div id="payment-section" class="d-none">
                <h5 class="fw-bold mb-4">Thanh toán</h5>

                <!-- Tổng tiền -->
                <div class="d-flex justify-content-between align-items-center mb-3 border-bottom border-secondary pb-2">
                    <span class="fw-semibold">Tổng tiền</span>
                    <span class="fw-bold fs-5 text-success" id="checkout-total">$0.00</span>
                </div>

                <p class="text-secondary mb-4 small">
                    Thanh toán sẽ được thực hiện <b>tại địa điểm đặt lịch</b>.
                </p>

                <!-- Mã khuyến mãi -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">Bạn có mã giảm giá?</label>
                    <div class="input-group">
                        <input type="text" id="promo-code" class="form-control bg-dark text-light border-secondary" placeholder="Nhập mã khuyến mãi" />
                        <button class="btn btn-outline-success" id="apply-promo">Áp dụng</button>
                    </div>
                    <small id="promo-message" class="text-warning d-none">Vui lòng nhập mã hợp lệ!</small>
                </div>

                <!-- Thông tin khách hàng -->
                <div class="mb-3 mt-4">
                    <label for="customer-name" class="form-label fw-semibold">Họ và tên</label>
                    <input type="text" id="customer-name" class="form-control bg-dark text-light border-secondary" placeholder="Nhập họ và tên của bạn" />
                </div>

                <div class="mb-3">
                    <label for="customer-phone" class="form-label fw-semibold">Số điện thoại</label>
                    <input type="text" id="customer-phone" class="form-control bg-dark text-light border-secondary" placeholder="Nhập số điện thoại" />
                </div>

                <button id="confirm-booking" class="btn btn-success mt-3 w-100">Hoàn tất đặt lịch</button>
            </div>

            <!-- ✅ THANK YOU SECTION -->
            <div id="thankyou-section" class="d-none text-center p-5">
                <svg class="mx-auto d-block mb-4" xmlns="http://www.w3.org/2000/svg" width="322" height="144" fill="none"><ellipse cx="233.859" cy="22.268" fill="#8E402B" rx="21.691" ry="21.624"></ellipse><path stroke="#fff" stroke-linejoin="round" stroke-width="2.789" d="M234.957 12.385v8.98h12.849"></path><path fill="#42494D" d="M86.47 51.717c38.217-5.921 75.401-12.357 105.354-19.565 12.653 22.654 25.822 57.921 30.212 86.238-36.607 8.666-68.428 15.188-107.936 24.713-6.972-34.238-15.298-63.571-27.63-91.386"></path><path stroke="#FAFAFC" stroke-linejoin="round" stroke-width="2.789" d="M167.848 43.782c2.972-1.15 4.273-5.076 3.011-7.995a6.87 6.87 0 0 0-5.936-4.13 6.88 6.88 0 0 0-6.354 3.46 6.26 6.26 0 0 0-.638 3.714M124.144 52.02c2.973-1.15 4.273-5.076 3.012-7.995a6.87 6.87 0 0 0-5.937-4.13 6.88 6.88 0 0 0-6.354 3.46 6.26 6.26 0 0 0-.638 3.714"></path><path fill="#696A6B" d="M126.751 124.105c-4.453-20.002-10.198-37.829-17.17-56.428 27.113-5.406 60.165-11.97 77.466-15.831a256 256 0 0 1 16.655 54.188 85659 85659 0 0 1-76.951 18.071"></path><path fill="#C8C9CA" d="M124.61 89.152c-1.1-4.792-2.468-9.52-4.095-14.161 6.305-1.264 13.991-2.799 18.016-3.71 1.429 4.36 3.136 9.428 4.11 13.928-5.589 1.342-18.031 3.943-18.031 3.943M147.358 84.44a133 133 0 0 0-4.095-14.162c6.305-1.264 13.99-2.799 18.016-3.71 1.429 4.36 3.136 9.428 4.109 13.928-5.588 1.342-18.03 3.944-18.03 3.944"></path><path fill="#3391D2" d="M170.111 79.444a133 133 0 0 0-4.095-14.162c6.304-1.264 13.99-2.798 18.015-3.71 1.43 4.36 3.137 9.428 4.11 13.928-5.588 1.342-18.03 3.944-18.03 3.944"></path><path fill="#5ABBFF" d="M130.033 107.43a132 132 0 0 0-4.095-14.162c6.305-1.264 13.99-2.798 18.016-3.71 1.429 4.36 3.136 9.428 4.109 13.928-5.588 1.342-18.03 3.944-18.03 3.944"></path><path fill="#E4EFF4" d="M152.781 102.717a133 133 0 0 0-4.095-14.162c6.304-1.264 13.99-2.798 18.015-3.71 1.43 4.36 3.137 9.428 4.11 13.928-5.588 1.342-18.03 3.944-18.03 3.944"></path><path fill="#5ABBFF" d="M175.533 97.72c-1.1-4.792-2.467-9.52-4.095-14.16 6.305-1.265 13.991-2.8 18.016-3.71 1.429 4.359 3.136 9.427 4.11 13.927-5.589 1.342-18.031 3.944-18.031 3.944"></path><path stroke="#FF9797" stroke-width="4.183" d="m154.138 89.88 7.696 4.442 10.328-13.324"></path><ellipse cx="273.924" cy="64.989" fill="#75777A" rx="4.346" ry="4.333"></ellipse><ellipse cx="61.94" cy="36.014" fill="#AADAFF" rx="3.317" ry="3.307"></ellipse><ellipse cx="6.839" cy="93.084" stroke="#FF9797" stroke-width="2.789" rx="5.006" ry="4.99"></ellipse><path fill="#4FA75D" d="M68.14 90.049a18.9 18.9 0 0 1-.592 5.732c-2.05 7.602-10.308 18.051-12.605 20.894a96 96 0 0 1-5.698-8.313c-4.156-6.561-8.078-12.286-6.858-20.721.908-6.284 5.547-12.526 12.366-12.75 8.441-.275 13.041 7.534 13.387 15.158"></path><ellipse cx="55.187" cy="88.105" fill="#212529" rx="6.37" ry="6.281" transform="rotate(-1.875 55.187 88.105)"></ellipse><path stroke="#B5CADB" stroke-width="1.394" d="M55.826 121.732c.301.988.734 1.931 1.287 2.804"></path><path stroke="#B5CADB" stroke-dasharray="5.86" stroke-width="1.394" d="M60.44 128.063a23.07 23.07 0 0 0 11.39 4.028c10.177.947 20.75-1.861 29.584-7.05"></path><path stroke="#99D1FF" stroke-width="1.394" d="M103.488 123.758a53 53 0 0 0 2.543-1.764"></path><path stroke="#B5CADB" stroke-dasharray="5.58" stroke-width="1.394" d="M317.352 87.992c-9.061 10.302-24.883 15.275-38.064 11.288-7.713-2.334-15.476-5.886-23.694-5.671a26.04 26.04 0 0 0-14.441 4.87c-4.055 2.922-7.406 7.82-6.192 12.66a10.45 10.45 0 0 0 2.442 4.373 13.5 13.5 0 0 0 11.65 4.374 12.23 12.23 0 0 0 9.671-7.638c1.765-4.804.035-10.367-3.274-14.277s-8.121-7.19-12.627-9.636c-17.43-9.46-40.67-10.233-64.406-1.417a31.8 31.8 0 0 0-7.154 4.41"></path><ellipse cx="315.124" cy="90.589" fill="#FF9797" rx="6.172" ry="6.153"></ellipse></svg>
                <!-- Hai dòng đầu căn giữa -->
                <h2 class="text-success mb-2 fw-bold">Cảm ơn!</h2>
                <p class="text-light fs-5 mb-5">
                    Đặt lịch thành công! Cảm ơn bạn đã tin tưởng, và chúng tôi mong được gặp lại bạn!
                </p>

                <!-- Khối calendar căn trái -->
                <div class="mx-auto text-start" style="max-width: 480px;">
                    <label class="text-light fw-semibold mb-2 d-block">
                        Thêm lịch hẹn vào lịch của bạn:
                    </label>

                    <!-- 🌙 Custom Dropdown -->
                    <div class="dropdown w-100 mb-3">
                        <button class="btn btn-dark border-secondary w-100 d-flex justify-content-between align-items-center"
                                type="button"
                                id="calendarDropdown"
                                data-bs-toggle="dropdown"
                                aria-expanded="false">
                            <span id="calendarSelected" class="d-flex align-items-center">
                                <span class="text-secondary">-- Chọn lịch --</span>
                            </span>
                            <i class="bi bi-chevron-down"></i>
                        </button>
                        <ul class="dropdown-menu w-100 bg-dark text-light border-secondary shadow">
                            <li>
                                <a class="dropdown-item text-light d-flex align-items-center" href="#" data-value="google">
                                    <img src="https://goodbone.trafft.com/_nuxt/google.svg" width="20" class="me-2" />
                                    Google Calendar
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-light d-flex align-items-center" href="#" data-value="outlook">
                                    <img src="https://goodbone.trafft.com/_nuxt/outlook.BDobdf2a.svg" width="20" class="me-2" />
                                    Outlook Calendar
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-light d-flex align-items-center" href="#" data-value="ical">
                                    <img src="https://goodbone.trafft.com/_nuxt/ical.B6Y7hcO-.svg" width="20" class="me-2" />
                                    Apple iCal
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-light d-flex align-items-center" href="#" data-value="yahoo">
                                    <img src="https://goodbone.trafft.com/_nuxt/yahoo.svg" width="20" class="me-2" />
                                    Yahoo Calendar
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button id="add-to-calendar" class="btn btn-success w-100 py-2 rounded-pill shadow-sm">
                        Thêm vào lịch
                    </button>
                </div>
            </div>



        </div>

        <!-- KHUNG PHẢI -->
        <div id="booking-right" class="col-lg-4 col-md-10 col-sm-12 p-4 rounded-4 bg-dark text-light mt-4 mt-lg-0">
            <h4 class="fw-bold mb-4">Chi tiết đặt lịch</h4>

            <div class="border-top border-secondary py-3">
                <i class="bi bi-briefcase me-2"></i>
                <span class="fw-semibold brand-booking">Chuyên khoa</span>
                <div id="selected-service" class="mt-2"></div>
            </div>

            <div class="border-top border-secondary py-3">
                <i class="bi bi-person me-2"></i>
                <span class="fw-semibold brand-booking">Nhân viên</span>
                <div id="selected-employee" class="mt-2"></div>
            </div>

            <div class="border-top border-secondary py-3">
                <i class="bi bi-calendar-date me-2"></i>
                <span class="fw-semibold brand-booking">Ngày & Giờ</span>
                <div id="selected-datetime" class="mt-2"></div>
            </div>

            <!-- Tổng tiền -->
            <div id="total-section" class="pt-3 border-top border-secondary d-none">
                <div class="d-flex justify-content-between">
                    <span class="fw-semibold brand-booking">Tổng tiền</span>
                    <span class="fw-bold" id="total-price">$0.00</span>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/booking.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
}

